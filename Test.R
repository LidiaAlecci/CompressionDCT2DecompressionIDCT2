#install.packages("dtt")
library(dtt)
source("Script.R")

matrixequals <- function(x, y){
  return(is.matrix(x) && is.matrix(y) && dim(x) == dim(y) && isTRUE(all.equal(x,y, tolerance = 1e-7)))
}

testMyDCT <- function(){
  v=c(231,32,233,161,24,71,140,245)
  res=matrix(c(401.99021,6.60002,109.16737,-112.78558,65.40738,121.83140,116.65649,28.80041))
  r=matrix(myDCT(v))
  if(matrixequals(r,res)){
    print("Test myDCT passed! Well Done!")
  }else{
    print("Test myDCT not passed: CHECK")
  }
}

testMyDCT2 <- function(){
  m <- matrix(c(231,247,234,193,11,97,193,87,
                32,40,202,190,24,195,70,149,
                233,248,245,100,210,203,174,57,
                161,245,167,167,177,47,167,192,
                24,124,9,43,81,125,41,65,
                71,204,217,180,243,114,30,129,
                140,36,239,8,8,165,127,178,
                245,107,173,70,112,181,245,228),ncol=8)
  
  res <- t(matrix(c(1118.750000,44.02219,75.9190503,-138.572411,3.500000,122.07806,195.043868,-101.604906,
                    77.190079,114.86821,-21.8014421,41.364135,8.777206,99.08296,138.171516,10.909280,
                    44.835154,-62.75245,111.6141142,-76.378966,124.422160,95.59842,-39.828797,58.523767,
                    -69.983665,-40.24089,-23.4970508,-76.732059,26.645775,-36.83283,66.189148,125.429731,
                    -109.000000,-43.34309,-55.5436908,8.173471,30.250000,-28.66024,2.441498,-94.143703,
                    -5.387836,56.63450,173.0215190,-35.423449,32.387825,33.45767,-58.116786,19.022561,
                    78.843969,-64.59241,118.6712031,-15.090484,-137.316928,-30.61967,-105.114114,39.813050,
                    19.788244,-78.18134,0.9723119,-72.346418,-21.578163,81.29990,63.710378,5.906181),ncol=8))
  r=myDCT2(m)
  if(matrixequals(r,res)){
    print("Test myDCT2 passed! Well Done!")
  }else{
    print("Test myDCT2 not passed: CHECK")
  }
}


testMyIDCT <- function(){
  res=matrix(c(231,32,233,161,24,71,140,245))
  c=matrix(c(401.99021,6.60002,109.16737,-112.78558,65.40738,121.83140,116.65649,28.80041))
  r=matrix(myIDCT(c))
  if(matrixequals(r,res)){
    print("Test myIDCT passed! Well Done!")
  }else{
    print("Test myIDCT not passed: CHECK")
  }
}

testMyIDCT2 <- function(){
  res <- matrix(c(231,247,234,193,11,97,193,87,
                32,40,202,190,24,195,70,149,
                233,248,245,100,210,203,174,57,
                161,245,167,167,177,47,167,192,
                24,124,9,43,81,125,41,65,
                71,204,217,180,243,114,30,129,
                140,36,239,8,8,165,127,178,
                245,107,173,70,112,181,245,228),ncol=8)
  
  c <- t(matrix(c(1118.750000,44.02219,75.9190503,-138.572411,3.500000,122.07806,195.043868,-101.604906,
                    77.190079,114.86821,-21.8014421,41.364135,8.777206,99.08296,138.171516,10.909280,
                    44.835154,-62.75245,111.6141142,-76.378966,124.422160,95.59842,-39.828797,58.523767,
                    -69.983665,-40.24089,-23.4970508,-76.732059,26.645775,-36.83283,66.189148,125.429731,
                    -109.000000,-43.34309,-55.5436908,8.173471,30.250000,-28.66024,2.441498,-94.143703,
                    -5.387836,56.63450,173.0215190,-35.423449,32.387825,33.45767,-58.116786,19.022561,
                    78.843969,-64.59241,118.6712031,-15.090484,-137.316928,-30.61967,-105.114114,39.813050,
                    19.788244,-78.18134,0.9723119,-72.346418,-21.578163,81.29990,63.710378,5.906181),ncol=8))
  r=myIDCT2(c)
  if(matrixequals(r,res)){
    print("Test myIDCT2 passed! Well Done!")
  }else{
    print("Test myIDCT2 not passed: CHECK")
  }
}

testDCT2DDT <- function(){
  m <- matrix(c(231,247,234,193,11,97,193,87,
                32,40,202,190,24,195,70,149,
                233,248,245,100,210,203,174,57,
                161,245,167,167,177,47,167,192,
                24,124,9,43,81,125,41,65,
                71,204,217,180,243,114,30,129,
                140,36,239,8,8,165,127,178,
                245,107,173,70,112,181,245,228),ncol=8)
  
  dct2m=dct(m, variant = 2, inverted=FALSE)
  
  idct2m=dct(dct2m, variant = 2, inverted=TRUE)
  
  if(matrixequals(m,idct2m)){
    print("Test DCT2 and IDCT2 package DTT passed! Well Done!")
  }else{
    print("Test DCT2 and IDCT2 package DTT not passed: CHECK")
  }
}

test <- function(){
  testMyDCT()
  testMyIDCT()
  testMyDCT2()
  testMyIDCT2()
  testDCT2DTT()
}
